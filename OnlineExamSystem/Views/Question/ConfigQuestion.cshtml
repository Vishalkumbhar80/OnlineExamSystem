@model List<OnlineExamSystem.Models.Question>
@{
    ViewData["Title"] = "Edit Questions";
    var examId = ViewBag.ExamId;
}

<h2>Questions for Exam @examId</h2>

<a asp-action="CreateQuestions" asp-controller="Question" asp-route-examId="@examId" class="btn btn-primary mb-3">Add New Question</a>

@* <a href="/Question/CreateQuestion/@examId" class="btn btn-sm btn-info">Config Question</a> *@

<table class="table table-bordered table-striped">
    <thead>
        <tr>
            <th>Id</th>
            <th>Title</th>
            <th>Marks</th>
            <th>Multiple Answer</th>
            <th>Action</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var q in Model)
        {
            <tr>
                <td>@q.Id</td>
                <td>@q.Title</td>
                <td>@q.Marks</td>
                <td>@(q.IsMultipleAnswer ? "Yes" : "No")</td>
                <td>
                    <a asp-action="EditQuestion" asp-route-id="@q.Id" class="btn btn-sm btn-warning">Edit</a>
                    <button class="btn btn-sm btn-danger delete-question" data-id="@q.Id">Delete</button>

                </td>
            </tr>
        }
    </tbody>
</table>

<a asp-action="Config" class="btn btn-secondary mt-3">Back to Exams</a>


<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    $(document).on('click', '.delete-question', function () {
        var id = $(this).data('id');
        if (confirm("Are you sure you want to delete this question?")) {
            $.ajax({
                url: '/Question/DeleteQuestion/' + id,
                type: 'POST',
                success: function (res) {
                    if (res.success) {
                        alert(res.message);
                        location.reload();
                    } else {
                        alert(res.message);
                    }
                },
                error: function () {
                    alert("Error deleting question!");
                }
            });
        }
    });
</script>

